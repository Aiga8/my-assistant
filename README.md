# My Assistant — модульные инструкции для Cursor (LLM + MCP)

Этот репозиторий устроен как набор **модулей**.
Каждый модуль — это отдельная задача/сценарий работы и набор правил (промпт), которые направляют LLM: что делать, какие инструменты вызывать (MCP), какой формат результата выдавать и куда сохранять артефакты.

## Как работает “команда” пользователя

Команда пользователя — это **входные данные** (например, `section_id`, ссылки, ограничения) + просьба выполнить задачу.
LLM **не исполняет команду “сам по себе”** — он должен сначала понять, **по каким правилам** работать (какой модуль применить).


## Маршрутизация команд → модуль (явные правила)

Используем простое правило маршрутизации:

- если команда про **маппинг автотестов на TestRail** (покрытие, сопоставление UI-автотестов с кейсами) → модуль `01-autotest-coverage`
- если команда про **ревью тест-кейсов в TestRail** → модуль `02-test-cases-review`
- если команда про **создание/написание тест-кейсов** → модуль `03-test-cases-writting`
- если команда про **создание/обновление тест-кейса по Playwright автотесту** → модуль `04-test-cases-from-autotests`
- если команда про **написание автотестов по тест-кейсам TestRail** → модуль `05-autotests-from-testrail`
- если команда про **ревью автотестов Playwright** → модуль `06-autotests-review`
- если команда про **подготовку improvement (Jira DS) — заголовок + текст** → модуль `07-improvements`
- если команда про **план демо / сценарий демо по заметкам** → модуль `08-demo-plan`
- если команда про **обновление тестов TestRail на основе новой фичи или бага** (Jira + секция/проект TestRail) → модуль `09-test-updates-from-features-bugs`
- если команда не подходит под эти описания → уточни у пользователя задачу и предложи завести новый модуль



## Флоу для модуля `01-autotest-coverage`

Ввод от пользователя:
- номер задачи (например: QAA-6265)
- путь к папке/файлу автотестов в `tests from solo-rtm` (или область/подпапка)
- для этапов 2–3: `section_id` секции TestRail (проект всегда 5)

Порядок работы (три этапа, см. `modules/01-autotest-coverage/README.md`):
1) **Этап 1:** сформировать описания автотестов → сохранить в `results/01-autotest-coverage/<задача>_<область>.md`
2) **Этап 2:** экспорт кейсов TestRail по `section_id` (project_id=5) → скрипт в модуле, результат `.json`/`.md` в `results/01-autotest-coverage/`
3) **Этап 3:** маппинг описаний на выгрузку → статусы Covered/Partial/Not found, отчёты и при необходимости пересборка рабочего файла

## Флоу для модуля `02-test-cases-review`

Ввод от пользователя:
- `SECTION_ID` (TestRail)
- ссылка на аналитику

Порядок работы:
1) открыть секцию TestRail по `SECTION_ID` (включая дочерние секции)
2) изучить аналитику
3) сделать ревью тест-кейсов: найти ошибки/пробелы/дубли/неоднозначности и несоответствия аналитике
4) выдать результат ревью (списком замечаний/правок по кейсам)

## Флоу для модуля `03-test-cases-writting`

Ввод от пользователя:
- `<название фичи/эпика>`
- `SECTION_ID` (TestRail)
- ссылка на аналитику
- (опционально) ссылка на чек-лист и/или макет (Figma)

Порядок работы:
1) собрать/открыть исходные материалы (аналитика/чек-лист/макет)
2) составить набор тест-кейсов по материалам
3) создать **только JSON-черновик для ревью** и сохранить в `results/03-test-cases-writting`
4) остановиться и дождаться команды пользователя
5) только по команде — добавить кейсы в TestRail


## Флоу для модуля `04-test-cases-from-autotests`

Ввод от пользователя:
- `SECTION_ID` (TestRail)
- файл(ы) с Playwright автотестами (в репозитории)
- режим: `create` или `update`

Порядок работы:
1) прочитать файл(ы) автотестов и выделить тесты
2) определить create/update (если в названии есть `[<caseId>]` → update этого кейса)
3) понять сценарий по коду теста (что делаем и что проверяем)
4) сформировать TestRail кейс (title/preconditions/steps/expected)
5) выдать результат **только JSON** для TestRail API


## Флоу для модуля `05-autotests-from-testrail`

Ввод от пользователя:
- `sectionId` (TestRail)
- ссылка на аналитику
- (опционально) DOM/HTML фрагменты

Порядок работы:
1) найти секцию в TestRail по `sectionId` (уточнить название/путь)
2) создать Jira-задачу на автотесты (Project **QA Automation**, Summary с **`[UI DS]`**, заполнить поля)
3) изучить аналитику
4) изучить тесты (кейсы) в секции TestRail
5) изучить статью Confluence “Recommended E2E Test Format”
6) при необходимости запросить/проверить DOM и `data-testid`
7) если найден `NEEDED data-testid`/`MISSING data-testid` — создать Jira-задачу на добавление атрибутов (пример: `DS-12116`)
8) написать автотест(ы) и сохранить в `results/05-autotests-from-testrail`
9) запустить автотест(ы) для проверки; если тест упал — сообщить, какие Assert N не прошли (не “подгонять” тест молча)

## Флоу для модуля `06-autotests-review`

Ввод от пользователя:

- путь(и) к файлам/папкам с автотестами в репозитории
- (опционально) ссылка на PR / Jira задачу / требования
- (опционально) Jira задачи на добавление `data-testid` (если такие уже заведены)

Порядок работы:

0) изучить “эталонные” тесты лидов и использовать их как baseline (папки `\tests from solo-rtm\trajectory` и `tests from solo-rtm\Routing`)
1) пройтись по каждому файлу и дать замечания
2) проверить локаторы (предпочтительно `data-testid`), стабильность и риски флейков
2.1) если пользователь дал Jira-задачи на `data-testid` — сверить, что все элементы без `data-testid` перечислены в задачах; если нет — вернуть список “пропущенных”
3) проверить структуру тестов (`describe`/`test`/`test.step`/Assert N — если это правило проекта)
4) если TestRail дан — через MCP подтянуть кейсы (по `[caseId]` или по секции) и проверить **полное соответствие** автотеста кейсам (а не только expected/asserты), включая метаданные (по ID из `testrail-field-ids.md`) и “Autotest: …” комментарий
5) выдать отдельным блоком рекомендации по стилю/паттернам по итогам “эталона”
6) выдать финальную сводку и сохранить отчёт в `results/06-autotests-review/`

## Флоу для модуля `07-improvements`

Ввод от пользователя:

- контекст/проблема/ожидаемое поведение
- (опционально) ссылки на Jira/Confluence/скриншоты

Порядок работы:

1) изучить входные материалы (если есть ссылки)
2) подготовить **Summary (заголовок)** в стиле проекта (prefix `Spreadsheet.` / `Linear.` / `EDM.` / ...)
3) подготовить **Description (текст)** со структурой: Context / Proposed Solution / Expected Behavior (без Acceptance criteria)
4) выдать пользователю только: **Summary** и **Description** (создание тикета делает пользователь)

## Флоу для модуля `08-demo-plan`

Ввод от пользователя:

- заметки/черновик в свободной форме

Порядок работы:

1) переписать заметки в читаемый Markdown-план без потери смысла
2) сохранить порядок пользователя
3) оставить `TODO:`/`[уточнить]` там, где не хватает данных (не выдумывать)
4) сохранить результат в `results/08-demo-plan/`

## Флоу для модуля `09-test-updates-from-features-bugs`

Ввод от пользователя:

- ключ задачи Jira (фича или баг)
- project_id и section_id (или секции) в TestRail
- (опционально) контекст: payload API, формат данных, ссылки

Порядок работы:

1) изучить задачу в Jira (description, комментарии)
2) получить описание секции и кейсы из TestRail
3) сопоставить изменения по задаче с тестами (описание секции, шаги/ожидания, новые сценарии, обратная совместимость)
4) сформировать документ-план: контекст, что изменилось, обновление секции, какие кейсы править/добавить, сводка действий
5) сохранить результат в `results/09-test-updates-from-features-bugs/` (имя: `dd_mm_yy_<JIRA_KEY>_section_<ID>_updates.md`)

## Где лежат модули

Все модули находятся в `modules/`.

- `modules/01-autotest-coverage/README.md` — маппинг автотестов на TestRail (3 этапа: описания, экспорт кейсов, сопоставление)
- `modules/02-test-cases-review/README.md` — ревью тест-кейсов в секции TestRail (включая поддерево)
- `modules/03-test-cases-writting/README.md` — создание тест-кейсов по аналитике и добавление в TestRail (после ревью)
- `modules/04-test-cases-from-autotests/README.md` — создание/обновление TestRail кейса по Playwright автотесту
- `modules/05-autotests-from-testrail/README.md` — написание Playwright автотестов на основе TestRail тест-кейсов
- `modules/06-autotests-review/README.md` — ревью Playwright автотестов
- `modules/07-improvements/README.md` — подготовка improvement (Jira DS): заголовок + текст
- `modules/08-demo-plan/README.md` — план демо / сценарий демо по заметкам
- `modules/09-test-updates-from-features-bugs/README.md` — обновление тестов TestRail на основе новой фичи или бага (Jira + секция TestRail)